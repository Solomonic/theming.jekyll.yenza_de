#!/usr/bin/env bash
#set -e # halt script on error

if [ -n $TRAVIS_TAG ]
then
	JEKYLL_ENV="production" bundle exec jekyll build
	git status
	git remote update > /dev/null
	git_remote_state=$(git status -uno | grep 'branch is ahead' | wc -l)
	if git_remote_state; then
		git add .
		git commit -m"[skip travis] Automated build"
	fi
	git remote set-url origin https://$ROBOT@github.com/Solomonic/theming.rasta_online.git
	git push origin HEAD:master --force
fi
